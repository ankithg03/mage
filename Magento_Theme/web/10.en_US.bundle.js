(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1131:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),s=a(30),o=a.n(s),i=a(46),u=a.n(i),c=a(4),d=a.n(c),l=a(5),p=a.n(l),m=a(7),h=a.n(m),f=a(6),g=a.n(f),y=a(3),v=a.n(y),C=a(8),k=a.n(C),N=a(2),w=a.n(N),S=a(193),L=a(1),D=a.n(L),_=a(880),O=a(879),b=a(98),P=a(890),I=a(10).checkBEMProps,R=function(e){function t(){var e,a;d()(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return a=h()(this,(e=g()(t)).call.apply(e,[this].concat(r))),w()(v()(a),"getDataAssembled",(function(e){var t=[];return e.forEach((function(e){var n=e.id,r=e.firstname,s=e.lastname,o=e.email,i=e.middlename,u=e.telephone,c=e.company,d=e.addresses,l=void 0===d?"":d,p=[],m=l.find((function(e){return!0===e.default_shipping}))||{};l.map((function(e){var t=e.city,a=e.company,n=e.firstname,r=e.lastname,s=e.fax,o=e.region.region,i=e.street,u=e.postcode,c=e.telephone;p.push(t,a,n,r,s,o,i,u,c)})),p.push(r,i,s,o,u,c),t.push({id:n,searchFields:p,name:r+" "+s||"-",postcode:m.postcode||"-",state:m.region?m.region.region:"-",company:m.company||"-",telephone:m.telephone?"<a class='telephone' href='tel:"+m.telephone+"'>"+(m.telephone||"-")+"</a>":"",reorder:"Re-Order",action:a.addOrderToCart})})),t})),w()(v()(a),"addOrderToCart",(function(e){Object(b.b)(P.a.salesRepresentativeGetOrderList(e)).then((function(t){return a.getOrders(e,t)}))})),a}var a,n;return k()(t,e),p()(t,[{key:"getOrders",value:(n=u()(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.salesRepresentativeGetOrderList.items.map((function(e){e.base_order_info.increment_id>0&&(n=e.base_order_info.increment_id)})),r=n,this.addReOrder(t,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"addReOrder",value:(a=u()(o.a.mark((function e(t,a){var n,r,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props,r=n.startLoader,s=n.stopLoader,i=n.setCurrentCustomer,r(),Object(b.a)(P.a.salesRepresentativeReOrder(t,parseInt(a))).then(i(t).then((function(){s(),history.push("/salesrep/customer/order/"+t+"/selectstore")})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this.state,t=e.search,a=e.currentPage,n=e.pageSize,s=e.customerData,o=e.pageSizeOptions,i=e.sortNum,u=e.sortValue,c=this.getSortedData(s,t,a,n);return I(D.a,O.a,r()({},this.props,{addClass:"customer",search:this.search,sortValue:u,sortNum:i,pageLimit:this.pageLimit,columnData:c.pageData,redirectPage:this.redirectPage,changePage:this.changePage,pageData:c.paginated,tableName:"Customer",totalEntries:s.length,sortCustomer:this.sortCustomer,pageSizeOptions:o,componentNames:[{name:"Name",key:"name"},{name:"Company Name",key:"company"},{name:"Telephone",key:"telephone",html:!0},{name:"Zip",key:"postcode"},{name:"State",key:"state"},{name:"Re-Order",key:"reorder",action:"action",actionParameter:"id"}]}))}}]),t}(_.a),F=a(331),M=a(65),z=a(898),A=a(79),x=a(177),E=a(10).checkBEMProps,V=function(e){function t(e){var a;return d()(this,t),a=h()(this,g()(t).call(this,e)),w()(v()(a),"clickCustomer",(function(e){["telephone"].includes(event.target.className)||a.onUpdate(e)})),a}var a;return k()(t,e),p()(t,[{key:"onUpdate",value:(a=u()(o.a.mark((function e(t){var a,n,r,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props,n=a.setCurrentCustomer,r=a.history,s=a.startLoader,i=a.stopLoader,s(),e.next=4,n(t);case 4:i(),r.push("/salesrep/customer/order/"+t+"/selectstore");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"componentDidMount",value:function(){(0,this.props.setMeta)({title:"Existing Customer"})}},{key:"componentWillUnmount",value:function(){(0,this.props.setMeta)(null)}},{key:"render",value:function(){return E(D.a,"div",{style:{backgroundImage:"url(".concat(Object(M.e)("/bg.png","salesrep"),")")}},E(D.a,z.a,null),E(D.a,R,r()({},this.props,{clickCustomer:this.clickCustomer})))}}]),t}(L.Component),B=Object(S.a)((function(e){return{customers:e.SalesRepCustomerReducer.customers}}),(function(e){return{fetchCustomer:function(t){return F.a.fetchCustomer(e,null)},setCurrentCustomer:function(t){return F.a.setCurrentCustomer(e,t,!0)},startLoader:function(){return A.a.startLoader(e)},stopLoader:function(){return A.a.stopLoader(e)},setMeta:function(t){return x.a.setMeta(e,t)}}}))(V);a.d(t,"default",(function(){return B}))},879:function(e,t,a){"use strict";var n=a(4),r=a.n(n),s=a(5),o=a.n(s),i=a(7),u=a.n(i),c=a(6),d=a.n(c),l=a(8),p=a.n(l),m=a(1),h=a.n(m),f=a(299),g=(a(882),a(10).checkBEMProps),y=function(e){function t(){return r()(this,t),u()(this,d()(t).apply(this,arguments))}return p()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.columnData,a=e.pageData,n=e.addClass,r=e.sortCustomer,s=e.clickCustomer,o=e.componentNames,i=e.tableName,u=e.sortValue,c=e.sortNum,d=a.totalItems;return g(h.a,"div",{className:"sales-rep-customer "+n},g(h.a,"div",{className:"panel"},g(h.a,f.b,this.props),g(h.a,"div",{className:"customer-data"},g(h.a,"table",{className:"customer-table"},g(h.a,"thead",null,g(h.a,"tr",{className:"customer-display-row"},o.map((function(e){return g(h.a,"td",{className:"sorting",onClick:function(){r(e.key)}},e.name,g(h.a,"i",{style:{display:u==e.key?"block":"none"},className:c%2==0?"down":"up"}))})))),d?g(h.a,"tbody",{className:"customer-display"},t.map((function(e){return e.loading?g(h.a,"tr",null,g(h.a,"td",{rowSpan:"4"},"Loading....")):g(h.a,"tr",{key:e.id,onClick:function(){s(e.id)},className:"customer-display-row-data"},o.map((function(t){return t.html?g(h.a,"td",{className:"sorting",dangerouslySetInnerHTML:{__html:e[t.key]}}):t.action?g(h.a,"td",{className:"sorting action",onClick:function(){e[t.action](e[t.actionParameter])}},e[t.key]):g(h.a,"td",{className:"sorting"},e[t.key])})))}))):g(h.a,"tbody",null,g(h.a,"tr",null,g(h.a,"td",{colSpan:"4"},g(h.a,"h2",null,"No items found for ",i)))))),g(h.a,f.a,this.props)))}}]),t}(m.Component);t.a=y},880:function(e,t,a){"use strict";var n=a(12),r=a.n(n),s=a(4),o=a.n(s),i=a(5),u=a.n(i),c=a(7),d=a.n(c),l=a(6),p=a.n(l),m=a(3),h=a.n(m),f=a(8),g=a.n(f),y=a(2),v=a.n(y),C=a(1),k=a.n(C),N=a(879),w=a(88),S=a(98),L=a(9),D=new(function(){function e(){o()(this,e)}return u()(e,[{key:"deleteCustomerById",value:function(e){return new L.a("salesRepresentativeDeleteCustomer").addArgument("id","Int!",e).addFieldList(this.getQueryOutput())}},{key:"getQueryOutput",value:function(){return["status","message"]}}]),e}()),_=a(10).checkBEMProps,O=function(e){function t(e){var a;return o()(this,t),a=d()(this,p()(t).call(this,e)),v()(h()(a),"redirectPage",(function(e){a.props.history.replace(e)})),v()(h()(a),"sortCustomer",(function(e){var t=a.state.customerData.slice(0),n=a.state,r=n.sortValue,s=n.sortNum;t.sort((function(t,a){if(r==e&&s%2==0){var n=[a,t];t=n[0],a=n[1]}var o=t[e].toString().toLowerCase(),i=a[e].toString().toLowerCase();return o<i?-1:o>i?1:0})),a.setState((function(a){return a.sortValue==e?a.sortNum=a.sortNum+1:a.sortNum=0,{customerData:t,sortValue:e,sortNum:a.sortNum}}))})),v()(h()(a),"getDataAssembled",(function(e){var t=[];return e.forEach((function(e){var n=e.id,r=e.firstname,s=e.lastname,o=e.email,i=e.middlename,u=e.telephone,c=e.company,d=e.addresses,l=void 0===d?"":d,p=[],m=l.find((function(e){return!0===e.default_shipping}))||{};l.map((function(e){var t=e.city,a=e.company,n=e.firstname,r=e.lastname,s=e.fax,o=e.region.region,i=e.street,u=e.postcode,c=e.telephone;p.push(t,a,n,r,s,o,i,u,c)})),p.push(r,i,s,o,u,c),t.push({id:n,name:r+" "+s||"-",postcode:m.postcode||"-",state:m.region?m.region.region:"-",company:m.company||"-",telephone:m.telephone?"<a class='telephone' href='tel:"+m.telephone+"'>"+(m.telephone||"-")+"</a>":"",searchFields:p,delete:"X",action:a.deleteCustomer})})),t})),v()(h()(a),"deleteCustomer",(function(e){window.confirm("Are you sure to delete this customer?")&&Object(S.a)(D.deleteCustomerById(e)).then((function(){(0,a.props.fetchCustomer)().then((function(){a.setState({customerData:a.getDataAssembled(a.props.customers)})}))}))})),v()(h()(a),"search",(function(e){a.setState({search:e,currentPage:1})})),v()(h()(a),"changePage",(function(e){a.setState({currentPage:e})})),v()(h()(a),"pageLimit",(function(e){a.setState({pageSize:parseInt(e)}),w.a.setItem("SalesRepCustomerContainer.pageSize",e)})),v()(h()(a),"getSearchedData",(function(e,t){return t=t.toLowerCase(),{customerCount:(e=e.filter((function(e){var a=e.searchFields;return(void 0===a?"":a).toString().toLowerCase().includes(t)}))).length,customerData:e}})),v()(h()(a),"paginatedData",(function(e,t){return e.splice(t.startIndex,t.pageSize)})),v()(h()(a),"getSortedData",(function(e,t,n,r){var s=a.getSearchedData(e,t),o=a.getPaginated(n,r,s.customerCount);return{paginated:o,pageData:a.paginatedData(s.customerData,o)}})),v()(h()(a),"getPaginated",(function(e,t,a){var n,r,s=Math.ceil(a/t);if(e<1?e=1:e>s&&(e=s),s<=5)n=1,r=s;else{var o=Math.floor(2.5),i=Math.ceil(2.5)-1;e<=o?(n=1,r=5):e+i>=s?(n=s-5+1,r=s):(n=e-o,r=e+i)}var u=(e-1)*t,c=Math.min(u+t-1,a-1),d=Array.from(Array(r+1-n).keys()).map((function(e){return n+e}));return{totalItems:a,currentPage:e,pageSize:t,totalPages:s,startPage:n,endPage:r,startIndex:u,endIndex:c,pages:d}})),a.state={customerData:[{loading:1}],search:"",currentPage:1,sortValue:"",sortNum:0,pageSize:parseInt(w.a.getItem("SalesRepCustomerContainer.pageSize"))||50,pageSizeOptions:[5,10,20,50,100]},a}return g()(t,e),u()(t,[{key:"componentDidMount",value:function(){var e=this;(0,this.props.fetchCustomer)().then((function(){e.setState({customerData:e.getDataAssembled(e.props.customers)})}))}},{key:"render",value:function(){var e=this.state,t=e.search,a=e.currentPage,n=e.pageSize,s=e.customerData,o=e.pageSizeOptions,i=e.sortNum,u=e.sortValue,c=this.getSortedData(s,t,a,n);return _(k.a,N.a,r()({},this.props,{addClass:"customer",search:this.search,sortValue:u,sortNum:i,pageLimit:this.pageLimit,columnData:c.pageData,redirectPage:this.redirectPage,changePage:this.changePage,pageData:c.paginated,tableName:"Customer",totalEntries:s.length,sortCustomer:this.sortCustomer,pageSize:n,pageSizeOptions:o,componentNames:[{name:"Name",key:"name"},{name:"Company Name",key:"company"},{name:"Telephone",key:"telephone",html:!0},{name:"Zip",key:"postcode"},{name:"State",key:"state"},{name:"Delete",key:"delete",action:"action",actionParameter:"id"}]}))}}]),t}(C.Component);a.d(t,"a",(function(){return O}))},882:function(e,t,a){},890:function(e,t,a){"use strict";var n=a(4),r=a.n(n),s=a(5),o=a.n(s),i=a(9),u=function(){function e(){r()(this,e)}return o()(e,[{key:"salesRepresentativeGetOrderList",value:function(e){return new i.a("salesRepresentativeGetOrderList").addArgument("customerId","Int!",e).addFieldList(this.getOrderOutputFields())}},{key:"salesRepresentativeReOrder",value:function(e,t){return new i.a("salesRepresentativeReorder").addArgument("customerId","Int!",e).addArgument("orderId","Int!",t).addFieldList(["base_currency_code"])}},{key:"getOrderOutputFields",value:function(){return[new i.a("items").addFieldList([new i.a("base_order_info").addFieldList(["grand_total","created_at","id","increment_id"]),new i.a("order_items").addFieldList(["name","sku","qty_ordered"]),new i.a("payment_info").addFieldList(["cc_owner","cc_last_4","cc_type",new i.a("additional_information").addFieldList([new i.a("customer_info").addFieldList(["first_name","middle_name","last_name"])])]),new i.a("shipping_info").addFieldList([new i.a("shipping_address").addFieldList(["firstname","middlename","lastname"])])])]}}]),e}();t.a=new u},898:function(e,t,a){"use strict";var n=a(4),r=a.n(n),s=a(5),o=a.n(s),i=a(7),u=a.n(i),c=a(6),d=a.n(c),l=a(8),p=a.n(l),m=a(1),h=a.n(m),f=(a(918),a(20)),g=a(10).checkBEMProps,y=function(e){function t(){return r()(this,t),u()(this,d()(t).apply(this,arguments))}return p()(t,e),o()(t,[{key:"render",value:function(){return g(h.a,"div",{className:"SalesRepCustHeader"},g(h.a,"div",{className:"title"},g(h.a,"h2",null," Select Customer "),g(h.a,"div",{className:"buttons"},g(h.a,f.a,{to:"/salesrep/dashboard"},g(h.a,"span",{className:"cancel"},"Cancel")),g(h.a,f.a,{to:"/salesrep/customer/new"},g(h.a,"span",{className:"new-customer"},"Create New Customer")))))}}]),t}(m.Component);t.a=y},918:function(e,t,a){}}]);